---
source_txt: fullstack_samples/prowler-master
converted_utc: 2025-12-18T11:26:14Z
part: 27
parts_total: 867
---

# FULLSTACK CODE DATABASE SAMPLES prowler-master

## Verbatim Content (Part 27 of 867)

````text
================================================================================
FULLSTACK SAMPLES CODE DATABASE (VERBATIM) - prowler-master
================================================================================
Generated: December 18, 2025
Source: fullstack_samples/prowler-master
================================================================================

NOTES:
- This output is verbatim because the source is user-owned.
- Large/binary files may be skipped by size/binary detection limits.

================================================================================

---[FILE: 0021_findings_new_performance_indexes_parent.py]---
Location: prowler-master/api/src/backend/api/migrations/0021_findings_new_performance_indexes_parent.py
Signals: Django

```python
import django.contrib.postgres.indexes
from django.db import migrations


class Migration(migrations.Migration):
    dependencies = [
        ("api", "0020_findings_new_performance_indexes_partitions"),
    ]

    operations = [
        migrations.AddIndex(
            model_name="finding",
            index=django.contrib.postgres.indexes.GinIndex(
                fields=["resource_services"], name="gin_find_service_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="finding",
            index=django.contrib.postgres.indexes.GinIndex(
                fields=["resource_regions"], name="gin_find_region_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="finding",
            index=django.contrib.postgres.indexes.GinIndex(
                fields=["resource_types"], name="gin_find_rtype_idx"
            ),
        ),
        migrations.RemoveIndex(
            model_name="finding",
            name="findings_uid_idx",
        ),
        migrations.RemoveIndex(
            model_name="finding",
            name="findings_filter_idx",
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0022_scan_summaries_performance_indexes.py]---
Location: prowler-master/api/src/backend/api/migrations/0022_scan_summaries_performance_indexes.py
Signals: Django

```python
# Generated by Django 5.1.8 on 2025-05-12 10:04

from django.contrib.postgres.operations import AddIndexConcurrently
from django.db import migrations, models


class Migration(migrations.Migration):
    atomic = False

    dependencies = [
        ("api", "0021_findings_new_performance_indexes_parent"),
        ("django_celery_beat", "0019_alter_periodictasks_options"),
    ]

    operations = [
        AddIndexConcurrently(
            model_name="scan",
            index=models.Index(
                condition=models.Q(("state", "completed")),
                fields=["tenant_id", "provider_id", "state", "-inserted_at"],
                name="scans_prov_state_ins_desc_idx",
            ),
        ),
        AddIndexConcurrently(
            model_name="scansummary",
            index=models.Index(
                fields=["tenant_id", "scan_id", "service"],
                name="ss_tenant_scan_service_idx",
            ),
        ),
        AddIndexConcurrently(
            model_name="scansummary",
            index=models.Index(
                fields=["tenant_id", "scan_id", "severity"],
                name="ss_tenant_scan_severity_idx",
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0023_resources_lookup_optimization.py]---
Location: prowler-master/api/src/backend/api/migrations/0023_resources_lookup_optimization.py
Signals: Django

```python
# Generated by Django 5.1.8 on 2025-05-12 10:18

from django.contrib.postgres.operations import AddIndexConcurrently
from django.db import migrations, models


class Migration(migrations.Migration):
    atomic = False

    dependencies = [
        ("api", "0022_scan_summaries_performance_indexes"),
    ]

    operations = [
        AddIndexConcurrently(
            model_name="resource",
            index=models.Index(
                fields=["tenant_id", "id"], name="resources_tenant_id_idx"
            ),
        ),
        AddIndexConcurrently(
            model_name="resource",
            index=models.Index(
                fields=["tenant_id", "provider_id"],
                name="resources_tenant_provider_idx",
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0024_findings_uid_index_partitions.py]---
Location: prowler-master/api/src/backend/api/migrations/0024_findings_uid_index_partitions.py
Signals: Django

```python
from functools import partial

from django.db import migrations

from api.db_utils import create_index_on_partitions, drop_index_on_partitions


class Migration(migrations.Migration):
    atomic = False

    dependencies = [
        ("api", "0023_resources_lookup_optimization"),
    ]

    operations = [
        migrations.RunPython(
            partial(
                create_index_on_partitions,
                parent_table="findings",
                index_name="find_tenant_uid_inserted_idx",
                columns="tenant_id, uid, inserted_at DESC",
            ),
            reverse_code=partial(
                drop_index_on_partitions,
                parent_table="findings",
                index_name="find_tenant_uid_inserted_idx",
            ),
        )
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0025_findings_uid_index_parent.py]---
Location: prowler-master/api/src/backend/api/migrations/0025_findings_uid_index_parent.py
Signals: Django

```python
from django.db import migrations, models


class Migration(migrations.Migration):
    dependencies = [
        ("api", "0024_findings_uid_index_partitions"),
    ]

    operations = [
        migrations.AddIndex(
            model_name="finding",
            index=models.Index(
                fields=["tenant_id", "uid", "-inserted_at"],
                name="find_tenant_uid_inserted_idx",
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0026_provider_secret_gcp_service_account.py]---
Location: prowler-master/api/src/backend/api/migrations/0026_provider_secret_gcp_service_account.py
Signals: Django

```python
from django.db import migrations


class Migration(migrations.Migration):
    dependencies = [
        ("api", "0025_findings_uid_index_parent"),
    ]

    operations = [
        migrations.RunSQL(
            "ALTER TYPE provider_secret_type ADD VALUE IF NOT EXISTS 'service_account';",
            reverse_sql=migrations.RunSQL.noop,
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0027_compliance_requirement_overviews.py]---
Location: prowler-master/api/src/backend/api/migrations/0027_compliance_requirement_overviews.py
Signals: Django

```python
# Generated by Django 5.1.8 on 2025-05-21 11:37

import uuid

import django.db.models.deletion
from django.db import migrations, models

import api.db_utils
import api.rls
from api.rls import RowLevelSecurityConstraint


class Migration(migrations.Migration):
    dependencies = [
        ("api", "0026_provider_secret_gcp_service_account"),
    ]

    operations = [
        migrations.CreateModel(
            name="ComplianceRequirementOverview",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                ("inserted_at", models.DateTimeField(auto_now_add=True)),
                ("compliance_id", models.TextField(blank=False)),
                ("framework", models.TextField(blank=False)),
                ("version", models.TextField(blank=True)),
                ("description", models.TextField(blank=True)),
                ("region", models.TextField(blank=False)),
                ("requirement_id", models.TextField(blank=False)),
                (
                    "requirement_status",
                    api.db_utils.StatusEnumField(
                        choices=[
                            ("FAIL", "Fail"),
                            ("PASS", "Pass"),
                            ("MANUAL", "Manual"),
                        ]
                    ),
                ),
                ("passed_checks", models.IntegerField(default=0)),
                ("failed_checks", models.IntegerField(default=0)),
                ("total_checks", models.IntegerField(default=0)),
                (
                    "scan",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="compliance_requirements_overviews",
                        related_query_name="compliance_requirements_overview",
                        to="api.scan",
                    ),
                ),
                (
                    "tenant",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE, to="api.tenant"
                    ),
                ),
            ],
            options={
                "db_table": "compliance_requirements_overviews",
                "abstract": False,
                "indexes": [
                    models.Index(
                        fields=["tenant_id", "scan_id"], name="cro_tenant_scan_idx"
                    ),
                    models.Index(
                        fields=["tenant_id", "scan_id", "compliance_id"],
                        name="cro_scan_comp_idx",
                    ),
                    models.Index(
                        fields=["tenant_id", "scan_id", "compliance_id", "region"],
                        name="cro_scan_comp_reg_idx",
                    ),
                    models.Index(
                        fields=[
                            "tenant_id",
                            "scan_id",
                            "compliance_id",
                            "requirement_id",
                        ],
                        name="cro_scan_comp_req_idx",
                    ),
                    models.Index(
                        fields=[
                            "tenant_id",
                            "scan_id",
                            "compliance_id",
                            "requirement_id",
                            "region",
                        ],
                        name="cro_scan_comp_req_reg_idx",
                    ),
                ],
                "constraints": [
                    models.UniqueConstraint(
                        fields=(
                            "tenant_id",
                            "scan_id",
                            "compliance_id",
                            "requirement_id",
                            "region",
                        ),
                        name="unique_tenant_compliance_requirement_overview",
                    )
                ],
            },
        ),
        migrations.AddConstraint(
            model_name="ComplianceRequirementOverview",
            constraint=RowLevelSecurityConstraint(
                "tenant_id",
                name="rls_on_compliancerequirementoverview",
                statements=["SELECT", "INSERT", "UPDATE", "DELETE"],
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0028_findings_check_index_partitions.py]---
Location: prowler-master/api/src/backend/api/migrations/0028_findings_check_index_partitions.py
Signals: Django

```python
from functools import partial

from django.db import migrations

from api.db_utils import create_index_on_partitions, drop_index_on_partitions


class Migration(migrations.Migration):
    atomic = False

    dependencies = [
        ("api", "0027_compliance_requirement_overviews"),
    ]

    operations = [
        migrations.RunPython(
            partial(
                create_index_on_partitions,
                parent_table="findings",
                index_name="find_tenant_scan_check_idx",
                columns="tenant_id, scan_id, check_id",
            ),
            reverse_code=partial(
                drop_index_on_partitions,
                parent_table="findings",
                index_name="find_tenant_scan_check_idx",
            ),
        )
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0029_findings_check_index_parent.py]---
Location: prowler-master/api/src/backend/api/migrations/0029_findings_check_index_parent.py
Signals: Django

```python
from django.db import migrations, models


class Migration(migrations.Migration):
    dependencies = [
        ("api", "0028_findings_check_index_partitions"),
    ]

    operations = [
        migrations.AddIndex(
            model_name="finding",
            index=models.Index(
                fields=["tenant_id", "scan_id", "check_id"],
                name="find_tenant_scan_check_idx",
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0030_lighthouseconfiguration.py]---
Location: prowler-master/api/src/backend/api/migrations/0030_lighthouseconfiguration.py
Signals: Django

```python
# Generated by Django 5.1.10 on 2025-06-12 12:45

import uuid

import django.core.validators
import django.db.models.deletion
from django.db import migrations, models

import api.rls


class Migration(migrations.Migration):
    dependencies = [
        ("api", "0029_findings_check_index_parent"),
    ]

    operations = [
        migrations.CreateModel(
            name="LighthouseConfiguration",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                ("inserted_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "name",
                    models.CharField(
                        help_text="Name of the configuration",
                        max_length=100,
                        validators=[django.core.validators.MinLengthValidator(3)],
                    ),
                ),
                (
                    "api_key",
                    models.BinaryField(
                        help_text="Encrypted API key for the LLM service"
                    ),
                ),
                (
                    "model",
                    models.CharField(
                        choices=[
                            ("gpt-4o-2024-11-20", "GPT-4o v2024-11-20"),
                            ("gpt-4o-2024-08-06", "GPT-4o v2024-08-06"),
                            ("gpt-4o-2024-05-13", "GPT-4o v2024-05-13"),
                            ("gpt-4o", "GPT-4o Default"),
                            ("gpt-4o-mini-2024-07-18", "GPT-4o Mini v2024-07-18"),
                            ("gpt-4o-mini", "GPT-4o Mini Default"),
                        ],
                        default="gpt-4o-2024-08-06",
                        help_text="Must be one of the supported model names",
                        max_length=50,
                    ),
                ),
                (
                    "temperature",
                    models.FloatField(default=0, help_text="Must be between 0 and 1"),
                ),
                (
                    "max_tokens",
                    models.IntegerField(
                        default=4000, help_text="Must be between 500 and 5000"
                    ),
                ),
                (
                    "business_context",
                    models.TextField(
                        blank=True,
                        default="",
                        help_text="Additional business context for this AI model configuration",
                    ),
                ),
                ("is_active", models.BooleanField(default=True)),
                (
                    "tenant",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE, to="api.tenant"
                    ),
                ),
            ],
            options={
                "db_table": "lighthouse_configurations",
                "abstract": False,
                "constraints": [
                    models.UniqueConstraint(
                        fields=("tenant_id",),
                        name="unique_lighthouse_config_per_tenant",
                    ),
                ],
            },
        ),
        migrations.AddConstraint(
            model_name="lighthouseconfiguration",
            constraint=api.rls.RowLevelSecurityConstraint(
                "tenant_id",
                name="rls_on_lighthouseconfiguration",
                statements=["SELECT", "INSERT", "UPDATE", "DELETE"],
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0031_scan_disable_on_cascade_periodic_tasks.py]---
Location: prowler-master/api/src/backend/api/migrations/0031_scan_disable_on_cascade_periodic_tasks.py
Signals: Django

```python
# Generated by Django 5.1.10 on 2025-06-23 10:04

import django.db.models.deletion
from django.db import migrations, models


class Migration(migrations.Migration):
    dependencies = [
        ("api", "0030_lighthouseconfiguration"),
        ("django_celery_beat", "0019_alter_periodictasks_options"),
    ]

    operations = [
        migrations.AlterField(
            model_name="scan",
            name="scheduler_task",
            field=models.ForeignKey(
                blank=True,
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                to="django_celery_beat.periodictask",
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0032_saml.py]---
Location: prowler-master/api/src/backend/api/migrations/0032_saml.py
Signals: Django

```python
# Generated by Django 5.1.10 on 2025-07-02 15:47

import uuid

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models

import api.db_utils
import api.rls


class Migration(migrations.Migration):
    dependencies = [
        ("api", "0031_scan_disable_on_cascade_periodic_tasks"),
    ]

    operations = [
        migrations.AlterField(
            model_name="integration",
            name="integration_type",
            field=api.db_utils.IntegrationTypeEnumField(
                choices=[
                    ("amazon_s3", "Amazon S3"),
                    ("aws_security_hub", "AWS Security Hub"),
                    ("jira", "JIRA"),
                    ("slack", "Slack"),
                ]
            ),
        ),
        migrations.CreateModel(
            name="SAMLToken",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                ("inserted_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                ("expires_at", models.DateTimeField(editable=False)),
                ("token", models.JSONField(unique=True)),
                (
                    "user",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "db_table": "saml_tokens",
            },
        ),
        migrations.CreateModel(
            name="SAMLConfiguration",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "email_domain",
                    models.CharField(
                        help_text="Email domain used to identify the tenant, e.g. prowlerdemo.com",
                        max_length=254,
                        unique=True,
                    ),
                ),
                (
                    "metadata_xml",
                    models.TextField(
                        help_text="Raw IdP metadata XML to configure SingleSignOnService, certificates, etc."
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "tenant",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE, to="api.tenant"
                    ),
                ),
            ],
            options={
                "db_table": "saml_configurations",
            },
        ),
        migrations.AddConstraint(
            model_name="samlconfiguration",
            constraint=api.rls.RowLevelSecurityConstraint(
                "tenant_id",
                name="rls_on_samlconfiguration",
                statements=["SELECT", "INSERT", "UPDATE", "DELETE"],
            ),
        ),
        migrations.AddConstraint(
            model_name="samlconfiguration",
            constraint=models.UniqueConstraint(
                fields=("tenant",), name="unique_samlconfig_per_tenant"
            ),
        ),
        migrations.CreateModel(
            name="SAMLDomainIndex",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("email_domain", models.CharField(max_length=254, unique=True)),
                (
                    "tenant",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE, to="api.tenant"
                    ),
                ),
            ],
            options={
                "db_table": "saml_domain_index",
            },
        ),
        migrations.AddConstraint(
            model_name="samldomainindex",
            constraint=models.UniqueConstraint(
                fields=("email_domain", "tenant"),
                name="unique_resources_by_email_domain",
            ),
        ),
        migrations.AddConstraint(
            model_name="samldomainindex",
            constraint=api.rls.BaseSecurityConstraint(
                name="statements_on_samldomainindex",
                statements=["SELECT", "INSERT", "UPDATE", "DELETE"],
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0033_processors_enum.py]---
Location: prowler-master/api/src/backend/api/migrations/0033_processors_enum.py
Signals: Django

```python
# Generated by Django 5.1.5 on 2025-03-03 15:46

from functools import partial

from django.db import migrations

from api.db_utils import PostgresEnumMigration, ProcessorTypeEnum, register_enum
from api.models import Processor

ProcessorTypeEnumMigration = PostgresEnumMigration(
    enum_name="processor_type",
    enum_values=tuple(
        processor_type[0] for processor_type in Processor.ProcessorChoices.choices
    ),
)


class Migration(migrations.Migration):
    atomic = False

    dependencies = [
        ("api", "0032_saml"),
    ]

    operations = [
        migrations.RunPython(
            ProcessorTypeEnumMigration.create_enum_type,
            reverse_code=ProcessorTypeEnumMigration.drop_enum_type,
        ),
        migrations.RunPython(
            partial(register_enum, enum_class=ProcessorTypeEnum),
            reverse_code=migrations.RunPython.noop,
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0034_processors.py]---
Location: prowler-master/api/src/backend/api/migrations/0034_processors.py
Signals: Django

```python
# Generated by Django 5.1.5 on 2025-03-26 13:04

import uuid

import django.db.models.deletion
from django.db import migrations, models

import api.db_utils
import api.rls
from api.rls import RowLevelSecurityConstraint


class Migration(migrations.Migration):
    dependencies = [
        ("api", "0033_processors_enum"),
    ]

    operations = [
        migrations.CreateModel(
            name="Processor",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                ("inserted_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "processor_type",
                    api.db_utils.ProcessorTypeEnumField(
                        choices=[("mutelist", "Mutelist")]
                    ),
                ),
                ("configuration", models.JSONField(default=dict)),
                (
                    "tenant",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE, to="api.tenant"
                    ),
                ),
            ],
            options={
                "db_table": "processors",
                "abstract": False,
                "indexes": [
                    models.Index(
                        fields=["tenant_id", "id"], name="processor_tenant_id_idx"
                    ),
                    models.Index(
                        fields=["tenant_id", "processor_type"],
                        name="processor_tenant_type_idx",
                    ),
                ],
            },
        ),
        migrations.AddConstraint(
            model_name="processor",
            constraint=models.UniqueConstraint(
                fields=("tenant_id", "processor_type"),
                name="unique_processor_types_tenant",
            ),
        ),
        migrations.AddConstraint(
            model_name="processor",
            constraint=RowLevelSecurityConstraint(
                "tenant_id",
                name="rls_on_processor",
                statements=["SELECT", "INSERT", "UPDATE", "DELETE"],
            ),
        ),
        migrations.AddField(
            model_name="scan",
            name="processor",
            field=models.ForeignKey(
                blank=True,
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="scans",
                related_query_name="scan",
                to="api.processor",
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0035_finding_muted_reason.py]---
Location: prowler-master/api/src/backend/api/migrations/0035_finding_muted_reason.py
Signals: Django

```python
import django.core.validators
import django.db.models.deletion
from django.db import migrations, models


class Migration(migrations.Migration):
    dependencies = [
        ("api", "0034_processors"),
    ]

    operations = [
        migrations.AddField(
            model_name="finding",
            name="muted_reason",
            field=models.TextField(
                blank=True,
                max_length=500,
                null=True,
                validators=[django.core.validators.MinLengthValidator(3)],
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0036_rfm_tenant_finding_index_partitions.py]---
Location: prowler-master/api/src/backend/api/migrations/0036_rfm_tenant_finding_index_partitions.py
Signals: Django

```python
from functools import partial

from django.db import migrations

from api.db_utils import create_index_on_partitions, drop_index_on_partitions


class Migration(migrations.Migration):
    atomic = False

    dependencies = [
        ("api", "0035_finding_muted_reason"),
    ]

    operations = [
        migrations.RunPython(
            partial(
                create_index_on_partitions,
                parent_table="resource_finding_mappings",
                index_name="rfm_tenant_finding_idx",
                columns="tenant_id, finding_id",
                method="BTREE",
            ),
            reverse_code=partial(
                drop_index_on_partitions,
                parent_table="resource_finding_mappings",
                index_name="rfm_tenant_finding_idx",
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0037_rfm_tenant_finding_index_parent.py]---
Location: prowler-master/api/src/backend/api/migrations/0037_rfm_tenant_finding_index_parent.py
Signals: Django

```python
from django.db import migrations, models


class Migration(migrations.Migration):
    dependencies = [
        ("api", "0036_rfm_tenant_finding_index_partitions"),
    ]

    operations = [
        migrations.AddIndex(
            model_name="resourcefindingmapping",
            index=models.Index(
                fields=["tenant_id", "finding_id"],
                name="rfm_tenant_finding_idx",
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0038_resource_failed_findings_count.py]---
Location: prowler-master/api/src/backend/api/migrations/0038_resource_failed_findings_count.py
Signals: Django

```python
from django.db import migrations, models


class Migration(migrations.Migration):
    dependencies = [
        ("api", "0037_rfm_tenant_finding_index_parent"),
    ]

    operations = [
        migrations.AddField(
            model_name="resource",
            name="failed_findings_count",
            field=models.IntegerField(default=0),
        )
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0039_resource_resources_failed_findings_idx.py]---
Location: prowler-master/api/src/backend/api/migrations/0039_resource_resources_failed_findings_idx.py
Signals: Django

```python
from django.contrib.postgres.operations import AddIndexConcurrently
from django.db import migrations, models


class Migration(migrations.Migration):
    atomic = False

    dependencies = [
        ("api", "0038_resource_failed_findings_count"),
    ]

    operations = [
        AddIndexConcurrently(
            model_name="resource",
            index=models.Index(
                fields=["tenant_id", "-failed_findings_count", "id"],
                name="resources_failed_findings_idx",
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0040_rfm_tenant_resource_index_partitions.py]---
Location: prowler-master/api/src/backend/api/migrations/0040_rfm_tenant_resource_index_partitions.py
Signals: Django

```python
from functools import partial

from django.db import migrations

from api.db_utils import create_index_on_partitions, drop_index_on_partitions


class Migration(migrations.Migration):
    atomic = False

    dependencies = [
        ("api", "0039_resource_resources_failed_findings_idx"),
    ]

    operations = [
        migrations.RunPython(
            partial(
                create_index_on_partitions,
                parent_table="resource_finding_mappings",
                index_name="rfm_tenant_resource_idx",
                columns="tenant_id, resource_id",
                method="BTREE",
            ),
            reverse_code=partial(
                drop_index_on_partitions,
                parent_table="resource_finding_mappings",
                index_name="rfm_tenant_resource_idx",
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0041_rfm_tenant_resource_parent_partitions.py]---
Location: prowler-master/api/src/backend/api/migrations/0041_rfm_tenant_resource_parent_partitions.py
Signals: Django

```python
from django.db import migrations, models


class Migration(migrations.Migration):
    dependencies = [
        ("api", "0040_rfm_tenant_resource_index_partitions"),
    ]

    operations = [
        migrations.AddIndex(
            model_name="resourcefindingmapping",
            index=models.Index(
                fields=["tenant_id", "resource_id"],
                name="rfm_tenant_resource_idx",
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0042_scan_scans_prov_ins_desc_idx.py]---
Location: prowler-master/api/src/backend/api/migrations/0042_scan_scans_prov_ins_desc_idx.py
Signals: Django

```python
from django.contrib.postgres.operations import AddIndexConcurrently
from django.db import migrations, models


class Migration(migrations.Migration):
    atomic = False

    dependencies = [
        ("api", "0041_rfm_tenant_resource_parent_partitions"),
        ("django_celery_beat", "0019_alter_periodictasks_options"),
    ]

    operations = [
        AddIndexConcurrently(
            model_name="scan",
            index=models.Index(
                condition=models.Q(("state", "completed")),
                fields=["tenant_id", "provider_id", "-inserted_at"],
                include=("id",),
                name="scans_prov_ins_desc_idx",
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0043_github_provider.py]---
Location: prowler-master/api/src/backend/api/migrations/0043_github_provider.py
Signals: Django

```python
# Generated by Django 5.1.7 on 2025-07-09 14:44

from django.db import migrations

import api.db_utils


class Migration(migrations.Migration):
    dependencies = [
        ("api", "0042_scan_scans_prov_ins_desc_idx"),
    ]

    operations = [
        migrations.AlterField(
            model_name="provider",
            name="provider",
            field=api.db_utils.ProviderEnumField(
                choices=[
                    ("aws", "AWS"),
                    ("azure", "Azure"),
                    ("gcp", "GCP"),
                    ("kubernetes", "Kubernetes"),
                    ("m365", "M365"),
                    ("github", "GitHub"),
                ],
                default="aws",
            ),
        ),
        migrations.RunSQL(
            "ALTER TYPE provider ADD VALUE IF NOT EXISTS 'github';",
            reverse_sql=migrations.RunSQL.noop,
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0044_integration_unique_configuration_per_tenant.py]---
Location: prowler-master/api/src/backend/api/migrations/0044_integration_unique_configuration_per_tenant.py
Signals: Django

```python
# Generated by Django 5.1.10 on 2025-07-17 11:52

from django.db import migrations, models


class Migration(migrations.Migration):
    dependencies = [
        ("api", "0043_github_provider"),
    ]

    operations = [
        migrations.AddConstraint(
            model_name="integration",
            constraint=models.UniqueConstraint(
                fields=("configuration", "tenant"),
                name="unique_configuration_per_tenant",
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0045_alter_scan_output_location.py]---
Location: prowler-master/api/src/backend/api/migrations/0045_alter_scan_output_location.py
Signals: Django

```python
# Generated by Django 5.1.10 on 2025-07-21 16:08

from django.db import migrations, models


class Migration(migrations.Migration):
    dependencies = [
        ("api", "0044_integration_unique_configuration_per_tenant"),
    ]

    operations = [
        migrations.AlterField(
            model_name="scan",
            name="output_location",
            field=models.CharField(blank=True, max_length=4096, null=True),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0046_lighthouse_gpt5.py]---
Location: prowler-master/api/src/backend/api/migrations/0046_lighthouse_gpt5.py
Signals: Django

```python
# Generated by Django 5.1.10 on 2025-08-20 09:04

from django.db import migrations, models


class Migration(migrations.Migration):
    dependencies = [
        ("api", "0045_alter_scan_output_location"),
    ]

    operations = [
        migrations.AlterField(
            model_name="lighthouseconfiguration",
            name="model",
            field=models.CharField(
                choices=[
                    ("gpt-4o-2024-11-20", "GPT-4o v2024-11-20"),
                    ("gpt-4o-2024-08-06", "GPT-4o v2024-08-06"),
                    ("gpt-4o-2024-05-13", "GPT-4o v2024-05-13"),
                    ("gpt-4o", "GPT-4o Default"),
                    ("gpt-4o-mini-2024-07-18", "GPT-4o Mini v2024-07-18"),
                    ("gpt-4o-mini", "GPT-4o Mini Default"),
                    ("gpt-5-2025-08-07", "GPT-5 v2025-08-07"),
                    ("gpt-5", "GPT-5 Default"),
                    ("gpt-5-mini-2025-08-07", "GPT-5 Mini v2025-08-07"),
                    ("gpt-5-mini", "GPT-5 Mini Default"),
                ],
                default="gpt-4o-2024-08-06",
                help_text="Must be one of the supported model names",
                max_length=50,
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0047_remove_integration_unique_configuration_per_tenant.py]---
Location: prowler-master/api/src/backend/api/migrations/0047_remove_integration_unique_configuration_per_tenant.py
Signals: Django

```python
# Generated by Django 5.1.10 on 2025-08-20 08:24

from django.db import migrations


class Migration(migrations.Migration):
    dependencies = [
        ("api", "0046_lighthouse_gpt5"),
    ]

    operations = [
        migrations.RemoveConstraint(
            model_name="integration",
            name="unique_configuration_per_tenant",
        ),
    ]
```

--------------------------------------------------------------------------------

````
