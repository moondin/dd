---
source_txt: fullstack_samples/zulip-main
converted_utc: 2025-12-18T13:06:14Z
part: 951
parts_total: 1290
---

# FULLSTACK CODE DATABASE SAMPLES zulip-main

## Verbatim Content (Part 951 of 1290)

````text
================================================================================
FULLSTACK SAMPLES CODE DATABASE (VERBATIM) - zulip-main
================================================================================
Generated: December 18, 2025
Source: fullstack_samples/zulip-main
================================================================================

NOTES:
- This output is verbatim because the source is user-owned.
- Large/binary files may be skipped by size/binary detection limits.

================================================================================

---[FILE: 0515_rename_named_group_can_mention_group_namedusergroup_can_mention_group_and_more.py]---
Location: zulip-main/zerver/migrations/0515_rename_named_group_can_mention_group_namedusergroup_can_mention_group_and_more.py
Signals: Django

```python
# Generated by Django 4.2.12 on 2024-04-19 04:05

from django.db import migrations


class Migration(migrations.Migration):
    dependencies = [
        ("zerver", "0514_update_usergroup_foreign_keys_to_namedusergroup"),
    ]

    operations = [
        migrations.AlterUniqueTogether(
            name="usergroup",
            unique_together=set(),
        ),
        migrations.RemoveField(
            model_name="usergroup",
            name="can_mention_group",
        ),
        migrations.RemoveField(
            model_name="usergroup",
            name="description",
        ),
        migrations.RemoveField(
            model_name="usergroup",
            name="is_system_group",
        ),
        migrations.RemoveField(
            model_name="usergroup",
            name="name",
        ),
        migrations.RenameField(
            model_name="namedusergroup",
            old_name="named_group_can_mention_group",
            new_name="can_mention_group",
        ),
        migrations.RenameField(
            model_name="namedusergroup",
            old_name="named_group_description",
            new_name="description",
        ),
        migrations.RenameField(
            model_name="namedusergroup",
            old_name="named_group_is_system_group",
            new_name="is_system_group",
        ),
        migrations.RenameField(
            model_name="namedusergroup",
            old_name="named_group_name",
            new_name="name",
        ),
        migrations.AlterUniqueTogether(
            name="namedusergroup",
            unique_together={("realm_for_sharding", "name")},
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0516_fix_confirmation_preregistrationusers.py]---
Location: zulip-main/zerver/migrations/0516_fix_confirmation_preregistrationusers.py
Signals: Django

```python
# Generated by Django 5.0.5 on 2024-04-29 19:24

from django.db import migrations

TOO_MANY_CONFIRMATIONS = """
DELETE FROM confirmation_confirmation
WHERE  id IN (WITH too_many_confirmations
                   AS (SELECT object_id,
                              MIN(confirmation_confirmation.id) AS exclude_id,
                              COUNT(*)
                       FROM   confirmation_confirmation
                       JOIN   zerver_preregistrationuser
                       ON     content_type_id = (SELECT id
                                                 FROM   django_content_type
                                                 WHERE  app_label = 'zerver'
                                                 AND    model = 'preregistrationuser')
                       AND    object_id = zerver_preregistrationuser.id
                       WHERE  referred_by_id IS NOT NULL
                       GROUP  BY object_id
                       HAVING COUNT(*) > 1)
              SELECT id
               FROM  confirmation_confirmation
                     JOIN too_many_confirmations
                       ON too_many_confirmations.object_id = confirmation_confirmation.object_id
                       AND content_type_id = (SELECT id
                                              FROM   django_content_type
                                              WHERE  app_label = 'zerver'
                                              AND    model = 'preregistrationuser')
                       AND id != exclude_id
)
"""

NO_CONFIRMATIONS_TEMP_TABLE = """
CREATE TEMPORARY TABLE zerver_0516_no_confirmations AS (
  SELECT id FROM zerver_preregistrationuser
   WHERE NOT EXISTS(SELECT 1
                      FROM confirmation_confirmation
                     WHERE content_type_id = (SELECT id
                                              FROM   django_content_type
                                              WHERE  app_label = 'zerver'
                                              AND    model = 'preregistrationuser')
                       AND object_id = zerver_preregistrationuser.id)
     AND referred_by_id IS NOT NULL
)
"""


class Migration(migrations.Migration):
    atomic = False

    dependencies = [
        (
            "zerver",
            "0515_rename_named_group_can_mention_group_namedusergroup_can_mention_group_and_more",
        ),
    ]

    operations = [
        migrations.RunSQL(TOO_MANY_CONFIRMATIONS, elidable=True),
        migrations.RunSQL(NO_CONFIRMATIONS_TEMP_TABLE, elidable=True),
        migrations.RunSQL(
            "DELETE FROM zerver_preregistrationuser_streams WHERE preregistrationuser_id IN (SELECT id FROM zerver_0516_no_confirmations)",
            elidable=True,
        ),
        migrations.RunSQL(
            "DELETE FROM zerver_preregistrationuser WHERE id IN (SELECT id FROM zerver_0516_no_confirmations)",
            elidable=True,
        ),
        migrations.RunSQL("DROP TABLE zerver_0516_no_confirmations", elidable=True),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0517_resort_edit_history.py]---
Location: zulip-main/zerver/migrations/0517_resort_edit_history.py
Signals: Django

```python
from django.db import migrations

# This migration was already run as 0497 on `main`, but was
# accidentally omitted on 8.x until this point.  This is left as a
# no-op on `main`, since it has either already run -- either as this
# migration number, if the user is upgrading from 8.x, or just now as
# 0497 if the user upgraded from a prior version.


class Migration(migrations.Migration):
    dependencies = [
        ("zerver", "0501_delete_dangling_usermessages"),
    ]

    operations = []
```

--------------------------------------------------------------------------------

---[FILE: 0518_merge.py]---
Location: zulip-main/zerver/migrations/0518_merge.py
Signals: Django

```python
from django.db import migrations

# See 0517 for the history of this migration merge commit.


class Migration(migrations.Migration):
    dependencies = [
        ("zerver", "0516_fix_confirmation_preregistrationusers"),
        ("zerver", "0517_resort_edit_history"),
    ]

    operations = []
```

--------------------------------------------------------------------------------

---[FILE: 0519_archivetransaction_restored_timestamp.py]---
Location: zulip-main/zerver/migrations/0519_archivetransaction_restored_timestamp.py
Signals: Django

```python
# Generated by Django 5.0.6 on 2024-05-08 00:59

from django.db import migrations, models


class Migration(migrations.Migration):
    dependencies = [
        ("zerver", "0518_merge"),
    ]

    operations = [
        migrations.AddField(
            model_name="archivetransaction",
            name="restored_timestamp",
            field=models.DateTimeField(db_index=True, null=True),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0520_attachment_zerver_attachment_realm_create_time.py]---
Location: zulip-main/zerver/migrations/0520_attachment_zerver_attachment_realm_create_time.py
Signals: Django

```python
# Generated by Django 5.0.6 on 2024-05-08 01:16

from django.contrib.postgres.operations import AddIndexConcurrently
from django.db import migrations, models


class Migration(migrations.Migration):
    atomic = False

    dependencies = [
        ("zerver", "0519_archivetransaction_restored_timestamp"),
    ]

    operations = [
        AddIndexConcurrently(
            model_name="attachment",
            index=models.Index(
                models.F("realm"),
                models.F("create_time"),
                name="zerver_attachment_realm_create_time",
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0521_multiuseinvite_include_realm_default_subscriptions_and_more.py]---
Location: zulip-main/zerver/migrations/0521_multiuseinvite_include_realm_default_subscriptions_and_more.py
Signals: Django

```python
# Generated by Django 4.2.10 on 2024-03-20 16:40

from django.db import migrations, models


class Migration(migrations.Migration):
    dependencies = [
        (
            "zerver",
            "0520_attachment_zerver_attachment_realm_create_time",
        ),
    ]

    operations = [
        migrations.AddField(
            model_name="multiuseinvite",
            name="include_realm_default_subscriptions",
            field=models.BooleanField(null=True),
        ),
        migrations.AddField(
            model_name="preregistrationuser",
            name="include_realm_default_subscriptions",
            field=models.BooleanField(null=True),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0522_set_include_realm_default_subscriptions_for_existing_objects.py]---
Location: zulip-main/zerver/migrations/0522_set_include_realm_default_subscriptions_for_existing_objects.py
Signals: Django

```python
# Generated by Django 5.0.5 on 2024-04-30 09:22

from django.db import migrations, transaction
from django.db.backends.base.schema import BaseDatabaseSchemaEditor
from django.db.migrations.state import StateApps
from django.db.models import Max, Min


def set_include_realm_default_subscriptions_for_existing_prereg_objects(
    apps: StateApps, schema_editor: BaseDatabaseSchemaEditor
) -> None:
    """Here, we set the value of include_realm_default_subscriptions for
    existing PreregistrationUser objects such that its value will
    match what would have happened prior to this migration. There are 3 cases:

    - User was not invited, and is being created by the API, LDAP
      auth, or some other process that does not generate a
      preregistration user object. This requires no migration.

    - User is using an invitation. In that case, both the new and
      previous code-level logic will use the streams on the invitation
      object. So the migration should use False for these.

    - User was not invited, but has a prereg_user created by the
      account registration flow. In this case, for new objects,
      create_preregistration_user create one with the Django models
      default of include_realm_default_subscription=True.

      If the preregistration object has streams specified, usually
      from being copied from an invitation for the user, the previous
      logic would ignore default streams; as a result, existing
      objects with referred_by=None, multiuse_invite=None,
      streams=None should be migrated to
      include_realm_default_subscription=True.
    """
    PreregistrationUser = apps.get_model("zerver", "PreregistrationUser")

    BATCH_SIZE = 1000
    max_id = PreregistrationUser.objects.filter(include_realm_default_subscriptions=None).aggregate(
        Max("id")
    )["id__max"]

    if max_id is None:
        # Do nothing if there are no PreregistrationUser on the server.
        return

    lower_bound = PreregistrationUser.objects.filter(
        include_realm_default_subscriptions=None
    ).aggregate(Min("id"))["id__min"]
    while lower_bound <= max_id:
        upper_bound = lower_bound + BATCH_SIZE - 1
        print(f"Processing batch {lower_bound} to {upper_bound} for PreregistrationUser")

        with transaction.atomic():
            PreregistrationUser.objects.filter(
                id__range=(lower_bound, upper_bound),
                include_realm_default_subscriptions=None,
                referred_by=None,
                multiuse_invite=None,
                streams=None,
            ).update(include_realm_default_subscriptions=True)
            PreregistrationUser.objects.filter(
                id__range=(lower_bound, upper_bound), include_realm_default_subscriptions=None
            ).update(include_realm_default_subscriptions=False)
        lower_bound += BATCH_SIZE


def set_include_realm_default_subscriptions_for_existing_multiuse_invites(
    apps: StateApps, schema_editor: BaseDatabaseSchemaEditor
) -> None:
    MultiuseInvite = apps.get_model("zerver", "MultiuseInvite")

    BATCH_SIZE = 1000
    max_id = MultiuseInvite.objects.filter(include_realm_default_subscriptions=None).aggregate(
        Max("id")
    )["id__max"]

    if max_id is None:
        # Do nothing if there are no MultiuseInvite on the server.
        return

    lower_bound = MultiuseInvite.objects.filter(include_realm_default_subscriptions=None).aggregate(
        Min("id")
    )["id__min"]
    while lower_bound <= max_id:
        upper_bound = lower_bound + BATCH_SIZE - 1
        print(f"Processing batch {lower_bound} to {upper_bound} for MultiuseInvite")

        MultiuseInvite.objects.filter(
            id__range=(lower_bound, upper_bound), include_realm_default_subscriptions=None
        ).update(include_realm_default_subscriptions=False)

        lower_bound += BATCH_SIZE


class Migration(migrations.Migration):
    atomic = False

    dependencies = [
        ("zerver", "0521_multiuseinvite_include_realm_default_subscriptions_and_more"),
    ]

    operations = [
        migrations.RunPython(
            set_include_realm_default_subscriptions_for_existing_prereg_objects,
            elidable=True,
            reverse_code=migrations.RunPython.noop,
        ),
        migrations.RunPython(
            set_include_realm_default_subscriptions_for_existing_multiuse_invites,
            elidable=True,
            reverse_code=migrations.RunPython.noop,
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0523_alter_multiuseinvite_subscribe_to_default_streams_and_more.py]---
Location: zulip-main/zerver/migrations/0523_alter_multiuseinvite_subscribe_to_default_streams_and_more.py
Signals: Django

```python
# Generated by Django 5.0.5 on 2024-04-30 09:48

from django.db import migrations, models


class Migration(migrations.Migration):
    dependencies = [
        ("zerver", "0522_set_include_realm_default_subscriptions_for_existing_objects"),
    ]

    operations = [
        migrations.AlterField(
            model_name="multiuseinvite",
            name="include_realm_default_subscriptions",
            field=models.BooleanField(default=True),
        ),
        migrations.AlterField(
            model_name="preregistrationuser",
            name="include_realm_default_subscriptions",
            field=models.BooleanField(default=True),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0524_remove_userprofile_onboarding_steps.py]---
Location: zulip-main/zerver/migrations/0524_remove_userprofile_onboarding_steps.py
Signals: Django

```python
# Generated by Django 5.0.6 on 2024-05-29 12:19

from django.db import migrations


class Migration(migrations.Migration):
    dependencies = [
        ("zerver", "0523_alter_multiuseinvite_subscribe_to_default_streams_and_more"),
    ]

    operations = [
        migrations.RemoveField(
            model_name="userprofile",
            name="onboarding_steps",
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0525_userpresence_last_update_id.py]---
Location: zulip-main/zerver/migrations/0525_userpresence_last_update_id.py
Signals: Django

```python
# Generated by Django 5.0.5 on 2024-05-02 02:17

from django.db import migrations, models


class Migration(migrations.Migration):
    atomic = False

    dependencies = [
        ("zerver", "0524_remove_userprofile_onboarding_steps"),
    ]

    operations = [
        # Create a new column, making it NULLable to avoid locking the table
        # rewriting rows with a non-NULL default value.
        migrations.AddField(
            model_name="userpresence",
            name="last_update_id",
            field=models.PositiveBigIntegerField(db_index=True, null=True),
        ),
        # This is an SQL noop, since Django doesn't add defaults at database level.
        # The default guarantees new rows will have a value. Old rows can get backfilled
        # in the next migration.
        migrations.AlterField(
            model_name="userpresence",
            name="last_update_id",
            field=models.PositiveBigIntegerField(db_index=True, default=0, null=True),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0526_user_presence_backfill_last_update_id_to_0.py]---
Location: zulip-main/zerver/migrations/0526_user_presence_backfill_last_update_id_to_0.py
Signals: Django

```python
from django.contrib.postgres.operations import AddIndexConcurrently
from django.db import migrations, models
from django.db.backends.base.schema import BaseDatabaseSchemaEditor
from django.db.migrations.state import StateApps


def backfill_user_presence_last_update_id(
    apps: StateApps, schema_editor: BaseDatabaseSchemaEditor
) -> None:
    UserPresence = apps.get_model("zerver", "UserPresence")

    max_id = UserPresence.objects.aggregate(models.Max("id"))["id__max"]
    if max_id is None:
        # Nothing to do if there are no rows yet.
        return

    BATCH_SIZE = 10000
    lower_bound = 0

    # Add a slop factor to make it likely we run past the end in case
    # of new rows created while we run. The next step will fail to
    # remove the null possibility if we race, so this is safe.
    max_id += BATCH_SIZE / 2

    while lower_bound < max_id:
        UserPresence.objects.filter(
            id__gt=lower_bound, id__lte=lower_bound + BATCH_SIZE, last_update_id=None
        ).update(last_update_id=0)
        lower_bound += BATCH_SIZE


class Migration(migrations.Migration):
    atomic = False

    dependencies = [
        ("zerver", "0525_userpresence_last_update_id"),
    ]

    operations = [
        migrations.RunPython(
            backfill_user_presence_last_update_id,
            reverse_code=migrations.RunPython.noop,
            elidable=True,
        ),
        migrations.AlterField(
            model_name="userpresence",
            name="last_update_id",
            field=models.PositiveBigIntegerField(db_index=True, default=0),
        ),
        AddIndexConcurrently(
            model_name="userpresence",
            index=models.Index(
                fields=["realm", "last_update_id"],
                name="zerver_userpresence_realm_last_update_id_idx",
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0527_presencesequence.py]---
Location: zulip-main/zerver/migrations/0527_presencesequence.py
Signals: Django

```python
# Generated by Django 5.0.5 on 2024-05-02 22:36

import django.db.models.deletion
from django.db import migrations, models
from django.db.backends.base.schema import BaseDatabaseSchemaEditor
from django.db.migrations.state import StateApps


def create_presence_sequence_for_old_realms(
    apps: StateApps, schema_editor: BaseDatabaseSchemaEditor
) -> None:
    Realm = apps.get_model("zerver", "Realm")
    PresenceSequence = apps.get_model("zerver", "PresenceSequence")

    max_id = Realm.objects.aggregate(models.Max("id"))["id__max"]
    if max_id is None:
        # Nothing to do if there are no rows yet.
        return

    BATCH_SIZE = 2000
    lower_bound = 0

    # Add a slop factor to make it likely we run past the end in case
    # of new rows created while we run. Races with realm creation are
    # pretty unlikely, and should throw an exception, so we should
    # catch them.
    max_id += BATCH_SIZE / 2

    while lower_bound < max_id:
        realm_ids = Realm.objects.filter(
            id__gt=lower_bound,
            id__lte=lower_bound + BATCH_SIZE,
            # Filter to realm whose PresenceSequence does not exist, to avoid
            # running into IntegrityError by trying to create duplicate PresenceSequence.
            presencesequence=None,
        ).values_list("id", flat=True)

        PresenceSequence.objects.bulk_create(
            PresenceSequence(realm_id=realm_id, last_update_id=0) for realm_id in realm_ids
        )

        lower_bound += BATCH_SIZE


class Migration(migrations.Migration):
    atomic = False

    dependencies = [
        ("zerver", "0526_user_presence_backfill_last_update_id_to_0"),
    ]

    operations = [
        migrations.CreateModel(
            name="PresenceSequence",
            fields=[
                (
                    "id",
                    models.AutoField(
                        auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
                    ),
                ),
                ("last_update_id", models.PositiveBigIntegerField()),
                (
                    "realm",
                    models.OneToOneField(
                        on_delete=django.db.models.deletion.CASCADE, to="zerver.realm"
                    ),
                ),
            ],
        ),
        migrations.RunPython(
            create_presence_sequence_for_old_realms,
            reverse_code=migrations.RunPython.noop,
            elidable=True,
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0528_realmauditlog_zerver_realmauditlog_user_activations_idx.py]---
Location: zulip-main/zerver/migrations/0528_realmauditlog_zerver_realmauditlog_user_activations_idx.py
Signals: Django

```python
from django.contrib.postgres.operations import AddIndexConcurrently
from django.db import migrations, models


class Migration(migrations.Migration):
    atomic = False

    dependencies = [
        ("zerver", "0527_presencesequence"),
    ]

    operations = [
        AddIndexConcurrently(
            model_name="realmauditlog",
            index=models.Index(
                # event_type__in:
                #   AbstractRealmAuditLog.USER_CREATED,
                #   AbstractRealmAuditLog.USER_ACTIVATED,
                #   AbstractRealmAuditLog.USER_DEACTIVATED,
                #   AbstractRealmAuditLog.USER_REACTIVATED,
                condition=models.Q(("event_type__in", [101, 102, 103, 104])),
                fields=["modified_user", "event_time"],
                name="zerver_realmauditlog_user_activations_idx",
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0529_fts_bigint_id.py]---
Location: zulip-main/zerver/migrations/0529_fts_bigint_id.py
Signals: Django

```python
from django.db import migrations


class Migration(migrations.Migration):
    dependencies = [
        ("zerver", "0528_realmauditlog_zerver_realmauditlog_user_activations_idx"),
    ]

    operations = [
        migrations.RunSQL(
            sql="alter table fts_update_log alter column id set data type bigint",
            reverse_sql="alter table fts_update_log alter column id set data type int",
            elidable=True,
        ),
        migrations.RunSQL(
            sql="alter sequence fts_update_log_id_seq as bigint",
            reverse_sql="alter sequence fts_update_log_id_seq as int",
            elidable=True,
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0530_alter_useractivity_id_alter_useractivityinterval_id.py]---
Location: zulip-main/zerver/migrations/0530_alter_useractivity_id_alter_useractivityinterval_id.py
Signals: Django

```python
from django.db import migrations, models


class Migration(migrations.Migration):
    atomic = False

    dependencies = [
        ("zerver", "0529_fts_bigint_id"),
    ]

    operations = [
        migrations.AlterField(
            model_name="useractivityinterval",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="useractivity",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0531_convert_most_ids_to_bigints.py]---
Location: zulip-main/zerver/migrations/0531_convert_most_ids_to_bigints.py
Signals: Django

```python
from typing import Any

from django.db import migrations, models
from django.db.backends.base.schema import BaseDatabaseSchemaEditor
from django.db.migrations.operations.base import Operation
from typing_extensions import override


class MigrateIdToBigint(Operation):
    """A helper to migrate the id of a given table to bigint.

    Necessary for many-to-many intermediate tables without models, due
    to https://code.djangoproject.com/ticket/32674"""

    def __init__(self, model_name: str) -> None:
        self.model_name = model_name

    @override
    def state_forwards(self, app_label: str, state: Any) -> None:
        pass

    @override
    def database_forwards(
        self,
        app_label: str,
        schema_editor: BaseDatabaseSchemaEditor,
        from_state: Any,
        to_state: Any,
    ) -> None:
        model = from_state.apps.get_model(app_label, self.model_name)
        table_name = model._meta.db_table
        seq_name = table_name + "_id_seq"
        schema_editor.execute(
            f"ALTER TABLE {schema_editor.quote_name(table_name)} ALTER COLUMN id SET DATA TYPE bigint"
        )
        schema_editor.execute(f"ALTER SEQUENCE {schema_editor.quote_name(seq_name)} AS bigint")

    @override
    def database_backwards(
        self,
        app_label: str,
        schema_editor: BaseDatabaseSchemaEditor,
        from_state: Any,
        to_state: Any,
    ) -> None:
        model = from_state.apps.get_model(app_label, self.model_name)
        table_name = model._meta.db_table
        seq_name = table_name + "_id_seq"
        schema_editor.execute(
            f"ALTER TABLE {schema_editor.quote_name(table_name)} ALTER COLUMN id SET DATA TYPE int"
        )
        schema_editor.execute(f"ALTER SEQUENCE {schema_editor.quote_name(seq_name)} AS int")

    @override
    def describe(self) -> str:
        return f"Migrates the 'id' column of {self.model_name} and its sequence to be a bigint.  Requires that the table have no foreign keys."


class Migration(migrations.Migration):
    atomic = False

    dependencies = [
        ("zerver", "0530_alter_useractivity_id_alter_useractivityinterval_id"),
    ]

    operations = [
        MigrateIdToBigint("archivedattachment_messages"),
        MigrateIdToBigint("attachment_messages"),
        MigrateIdToBigint("attachment_scheduled_messages"),
        MigrateIdToBigint("defaultstreamgroup_streams"),
        MigrateIdToBigint("multiuseinvite_streams"),
        MigrateIdToBigint("preregistrationuser_streams"),
        MigrateIdToBigint("scheduledemail_users"),
        MigrateIdToBigint("userprofile_groups"),
        MigrateIdToBigint("userprofile_user_permissions"),
        migrations.AlterField(
            model_name="alertword",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="archivedattachment",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="archivedreaction",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="archivedsubmessage",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="archivetransaction",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="attachment",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="botconfigdata",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="botstoragedata",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="customprofilefield",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="customprofilefieldvalue",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="defaultstream",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="defaultstreamgroup",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="draft",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="emailchangestatus",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="groupgroupmembership",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="huddle",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="missedmessageemailaddress",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="multiuseinvite",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="muteduser",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="onboardingstep",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="preregistrationrealm",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="preregistrationuser",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="presencesequence",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="pushdevicetoken",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="reaction",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="realmauditlog",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="realmauthenticationmethod",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="realmdomain",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="realmemoji",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="realmfilter",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="realmplayground",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="realmreactivationstatus",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="realmuserdefault",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="scheduledemail",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="scheduledmessage",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="scheduledmessagenotificationemail",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="service",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="stream",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="submessage",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="subscription",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="usergroup",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="usergroupmembership",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="userpresence",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="userstatus",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
        migrations.AlterField(
            model_name="usertopic",
            name="id",
            field=models.BigAutoField(
                auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

---[FILE: 0532_realm_can_create_public_channel_group.py]---
Location: zulip-main/zerver/migrations/0532_realm_can_create_public_channel_group.py
Signals: Django

```python
# Generated by Django 5.0.6 on 2024-05-23 14:02

import django.db.models.deletion
from django.db import migrations, models


class Migration(migrations.Migration):
    dependencies = [
        ("zerver", "0531_convert_most_ids_to_bigints"),
    ]

    operations = [
        migrations.AddField(
            model_name="realm",
            name="can_create_public_channel_group",
            field=models.ForeignKey(
                null=True,
                on_delete=django.db.models.deletion.RESTRICT,
                related_name="+",
                to="zerver.usergroup",
            ),
        ),
    ]
```

--------------------------------------------------------------------------------

````
